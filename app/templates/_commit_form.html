{% import 'bootstrap/wtf.html' as wtf %}

<form method="POST" action="{{ url_for('create_post', option='commit', id=0) }}">
    <table class="table">
        <tr>
            <td style="width: 30%">{{ wtf.form_field(commit_form.course) }}</td>
            <td style="width: 30%">{{ wtf.form_field(commit_form.assignment) }}</td>
            <td style="width: 30%">{{ wtf.form_field(commit_form.time_spent) }}</td>
        </tr>

        <tr>
            <td colspan="3">{{ wtf.form_field(commit_form.post, style='resize:none') }}</td>
        </tr>
        <tr>
            <td style="align-al: flex-end">{{ wtf.form_field(commit_form.submit) }}</td>
        </tr>
    </table>

</form>

<script>
    let course_select = document.getElementById('course');
    let assignment_select = document.getElementById('assignment');

    course_select.onchange = function() {
        course = course_select.value;
        fetch('/set_assignment_choices/' + course).then(function (response) {
            var rjson = response.json();
            rjson.then(function(data) {
                let optionHTML = '';
                for (let assignment of data.assignments) {
                    optionHTML += '<option value="' + assignment.id +'">' + assignment.title + '</option>';
                }
                assignment_select.innerHTML = optionHTML;
            });
        });

    }
</script>